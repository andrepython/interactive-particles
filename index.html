<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Interactive Text Morphing - Andre Python</title>
<style>
  html, body {
    margin: 0; padding: 0; overflow: hidden; background: #111;
    display: flex; justify-content: center; align-items: center; height: 100vh;
    font-family: 'Roboto', sans-serif;
  }
  canvas {
    display: block;
    background: #111;
  }
</style>
</head>
<body>
<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let width, height;
function resize() {
  width = window.innerWidth;
  height = window.innerHeight;
  canvas.width = width;
  canvas.height = height;
}
resize();
window.addEventListener('resize', resize);

const offCanvas = document.createElement('canvas');
const offCtx = offCanvas.getContext('2d');

const text = " Welcome";
const fontSize = 120;
offCanvas.width = 800;
offCanvas.height = 200;

offCtx.font = `bold ${fontSize}px 'Roboto', sans-serif`;
offCtx.fillStyle = 'white';
offCtx.textBaseline = 'middle';
offCtx.textAlign = 'center';
offCtx.clearRect(0, 0, offCanvas.width, offCanvas.height);
offCtx.fillText(text, offCanvas.width / 2, offCanvas.height / 2);

const imageData = offCtx.getImageData(0, 0, offCanvas.width, offCanvas.height);

const particles = [];
const PARTICLE_SIZE = 1;
const GAP = 3;  // space between sampled pixels

// Extract pixel positions from text imageData
for(let y = 0; y < offCanvas.height; y += GAP){
  for(let x = 0; x < offCanvas.width; x += GAP){
    const index = (y * offCanvas.width + x) * 4;
    if(imageData.data[index + 3] > 128) { // alpha > 128 means pixel is visible
      // Map x,y from offCanvas to main canvas center
      const posX = x + (width - offCanvas.width) / 2;
      const posY = y + (height - offCanvas.height) / 2;
      particles.push({
        x: Math.random() * width,
        y: Math.random() * height,
        tx: posX,
        ty: posY,
        vx: 0,
        vy: 0
      });
    }
  }
}

let mouse = {x: null, y: null};
canvas.addEventListener('mousemove', e => {
  mouse.x = e.clientX;
  mouse.y = e.clientY;
});
canvas.addEventListener('mouseleave', e => {
  mouse.x = null;
  mouse.y = null;
});

function animate() {
  ctx.clearRect(0, 0, width, height);

  particles.forEach(p => {
    // Move particles toward target position
    const dx = p.tx - p.x;
    const dy = p.ty - p.y;
    p.vx += dx * 0.1;
    p.vy += dy * 0.1;

    // Apply some friction
    p.vx *= 0.75;
    p.vy *= 0.75;

    // Mouse repulsion
    if(mouse.x !== null && mouse.y !== null){
      const mx = p.x - mouse.x;
      const my = p.y - mouse.y;
      const dist = Math.sqrt(mx * mx + my * my);
      const minDist = 80;
      if(dist < minDist){
        const angle = Math.atan2(my, mx);
        const force = (minDist - dist) / minDist;
        p.vx += Math.cos(angle) * force * 5;
        p.vy += Math.sin(angle) * force * 5;
      }
    }

    p.x += p.vx;
    p.y += p.vy;

    // Draw particle
    ctx.beginPath();
    ctx.fillStyle = '#00ffff';
    ctx.arc(p.x, p.y, PARTICLE_SIZE, 0, Math.PI * 2);
    ctx.fill();
  });

  requestAnimationFrame(animate);
}

animate();
</script>
</body>
</html>
